# üîó –ì–¥–µ –≤–∑—è—Ç—å URL –≤–∞—à–µ–≥–æ API

–í–∞—à API - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç –≤ `packages/core`, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Express —Å–µ—Ä–≤–µ—Ä–µ.

## üìç –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **–ü–∞–∫–µ—Ç:** `packages/core`
- **–ü–æ—Ä—Ç:** `3000` (–∏–ª–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PORT` –≤ `.env`)
- **Health check:** `http://localhost:3000/health`
- **API endpoints:**
  - `GET /api/bots` - —Å–ø–∏—Å–æ–∫ –±–æ—Ç–æ–≤
  - `GET /api/bot/:id/schema` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ö–µ–º—É
  - `POST /api/bot/:id/schema` - –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É

## üéØ –í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è URL

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Vercel —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º)

–ï—Å–ª–∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
cd packages/core
npm run dev
```

**URL:** `http://localhost:3000`

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–æ—Ç URL –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –Ω–∞ Vercel, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- `localhost` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
- Vercel —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ `localhost`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok (–±—ã—Å—Ç—Ä–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

ngrok —Å–æ–∑–¥–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok:**
   ```bash
   # macOS
   brew install ngrok
   
   # –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç:**
   ```bash
   cd packages/core
   npm run dev
   ```

3. **–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ ngrok:**
   ```bash
   ngrok http 3000
   ```

4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://abc123.ngrok.io`)

5. **–û–±–Ω–æ–≤–∏—Ç–µ `packages/frontend/script.js`:**
   ```javascript
   const API_BASE_URL = window.location.hostname === 'localhost' 
     ? 'http://localhost:3000' 
     : 'https://abc123.ngrok.io'; // ‚Üê URL –∏–∑ ngrok
   ```

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** ngrok –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π URL –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Vercel (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

Vercel –º–æ–∂–µ—Ç —Ö–æ—Å—Ç–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥, –Ω–æ –∏ API:

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Vercel:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ https://vercel.com
   - –ù–∞–∂–º–∏—Ç–µ "Add New Project"
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `BogdanMod/lego_bot`
   - **Root Directory:** `packages/core`
   - **Framework Preset:** `Other` –∏–ª–∏ `Other (Node.js)`
   - **Build Command:** `npm run build`
   - **Output Directory:** `dist`
   - **Install Command:** `npm install`
   - **Start Command:** `npm start`

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   
   **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
   - `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
     ```
     postgresql://username:password@host:port/database
     ```
     –ü—Ä–∏–º–µ—Ä: `postgresql://postgres:password@db.example.com:5432/dialogue_constructor`
   
   - `REDIS_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
     ```
     redis://host:port
     ```
     –ü—Ä–∏–º–µ—Ä: `redis://redis.example.com:6379`
     –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ): `redis://localhost:6379`
   
   - `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–≥–æ Telegram –±–æ—Ç–∞
     ```
     –ü–æ–ª—É—á–∏—Ç—å —É @BotFather: /newbot ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∏–º—è ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω
     ```
     –ü—Ä–∏–º–µ—Ä: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`
   
   - `ENCRYPTION_KEY` - –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ –±–æ—Ç–æ–≤
     ```
     –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞
     ```
     –ü—Ä–∏–º–µ—Ä: `my-super-secret-encryption-key-32-chars-long!!`
     ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö!
   
   **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
   - `FRONTEND_URL` - URL –≤–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
     ```
     –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: http://localhost:5173
     ```
     –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞: `https://lego-bot-frontend.vercel.app`
   
   - `ROUTER_URL` –∏–ª–∏ `WEBHOOK_URL` - URL —Ä–æ—É—Ç–µ—Ä–∞ –¥–ª—è webhook
     ```
     –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: http://localhost:3001
     ```
     –ü—Ä–∏–º–µ—Ä: `https://vancouver-dimensional-pushed-condo.trycloudflare.com`
     –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: `ROUTER_URL` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ `WEBHOOK_URL`
   
   - `PORT` - –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
     ```
     –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3000
     ```
     –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Vercel –æ–±—ã—á–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–π –ø–æ—Ä—Ç

3. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø–æ–ª—É—á–∏—Ç–µ URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://your-app.vercel.app`)

4. **–û–±–Ω–æ–≤–∏—Ç–µ `packages/frontend/script.js`:**
   ```javascript
   const API_BASE_URL = window.location.hostname === 'localhost' 
     ? 'http://localhost:3000' 
     : 'https://your-app.vercel.app'; // ‚Üê URL –∏–∑ Vercel
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Railway (–ø—Ä–æ—Å—Ç–æ, —Å –ë–î)

Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç PostgreSQL –∏ Redis –∏–∑ –∫–æ—Ä–æ–±–∫–∏:

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç:** https://railway.app
2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç:**
   - "New Project" ‚Üí "Deploy from GitHub"
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `BogdanMod/lego_bot`
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:**
   - –î–æ–±–∞–≤—å—Ç–µ PostgreSQL (Railway —Å–æ–∑–¥–∞—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - –î–æ–±–∞–≤—å—Ç–µ Redis (Railway —Å–æ–∑–¥–∞—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - –î–æ–±–∞–≤—å—Ç–µ "New Service" ‚Üí "GitHub Repo" ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–µ–ø–ª–æ–π:**
   - **Root Directory:** `packages/core`
   - **Build Command:** `npm run build`
   - **Start Command:** `npm start`
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - `DATABASE_URL` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ PostgreSQL —Å–µ—Ä–≤–∏—Å–∞
   - `REDIS_URL` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ Redis —Å–µ—Ä–≤–∏—Å–∞
   - `TELEGRAM_BOT_TOKEN`, `ENCRYPTION_KEY`, `FRONTEND_URL`, `ROUTER_URL`
6. **–ü–æ–ª—É—á–∏—Ç–µ URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://your-app.railway.app`)
7. **–û–±–Ω–æ–≤–∏—Ç–µ `packages/frontend/script.js`**

### –í–∞—Ä–∏–∞–Ω—Ç 5: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Render (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç:** https://render.com
2. **–°–æ–∑–¥–∞–π—Ç–µ "New Web Service"**
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - **Root Directory:** `packages/core`
   - **Build Command:** `npm install && npm run build`
   - **Start Command:** `npm start`
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
4. **–ü–æ–ª—É—á–∏—Ç–µ URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://your-app.onrender.com`)
5. **–û–±–Ω–æ–≤–∏—Ç–µ `packages/frontend/script.js`**

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **ngrok** –∏–ª–∏ **Cloudflare Tunnel** –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ API

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Vercel** (–µ—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ç–∞–º) –∏–ª–∏ **Railway/Render** (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –ë–î)

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è URL, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health check:**
   ```
   https://your-api-url.com/health
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
   ```json
   {
     "status": "ok",
     "databases": {
       "postgres": "connected",
       "redis": "connected"
     }
   }
   ```

2. **–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab
   - –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/bots` –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 200 OK (–ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

## üìù –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è URL

1. –û–±–Ω–æ–≤–∏—Ç–µ `packages/frontend/script.js`:
   ```javascript
   const API_BASE_URL = window.location.hostname === 'localhost' 
     ? 'http://localhost:3000' 
     : 'https://your-api-url.com'; // ‚Üê –í–∞—à —Ä–µ–∞–ª—å–Ω—ã–π URL
   ```

2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ø—É—à—Ç–µ:
   ```bash
   git add packages/frontend/script.js
   git commit -m "Update API URL"
   git push
   ```

3. Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

