# üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã: –ë–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîç –ü–æ—à–∞–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Health Check API

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://lego-bot-core.vercel.app/health
```

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```json
{
  "status": "ok",
  "databases": {
    "postgres": "connected",
    "redis": "connected"
  }
}
```

**–ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `status: "degraded"` –∏–ª–∏ –æ—à–∏–±–∫–∏:**
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –∏ `REDIS_URL` –≤ Vercel

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Vercel

1. –í Vercel –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç `lego-bot-core`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Deployments**
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ **Logs** (–∏–ª–∏ —Ç—Ä–∏ —Ç–æ—á–∫–∏ ‚Üí View Logs)
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:**
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- –û—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
- –û—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `TELEGRAM_BOT_TOKEN`

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel

1. –í Vercel: **Settings ‚Üí Environment Variables**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

#### ‚úÖ DATABASE_URL
–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
postgresql://postgres.xxxxx:–ü–ê–†–û–õ–¨@host:port/postgres
```

–ò–ª–∏ Connection Pooling:
```
postgresql://postgres.xxxxx:–ü–ê–†–û–õ–¨@aws-0-eu-central-1.pooler.supabase.com:6543/postgres?pgbouncer=true&transaction_mode=transaction
```

#### ‚úÖ REDIS_URL
–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
rediss://default:–ü–ê–†–û–õ–¨@fresh-eft-30867.upstash.io:6379
```

#### ‚úÖ TELEGRAM_BOT_TOKEN
–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–∫–µ–Ω –æ—Ç @BotFather, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
```

#### ‚úÖ ENCRYPTION_KEY
–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
E4fAhUyp2RRU19XjpjXwQw690MtapnAx...
```

#### ‚úÖ FRONTEND_URL
```
https://lego-bot-frontend.vercel.app
```

#### ‚úÖ ROUTER_URL
```
https://vancouver-dimensional-pushed-condo.trycloudflare.com
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç**!

1. –í Vercel: **Deployments**
2. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
3. –ù–∞–∂–º–∏—Ç–µ —Ç—Ä–∏ —Ç–æ—á–∫–∏ (‚ãÆ) ‚Üí **Redeploy**
4. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π –∏–∑ GitHub

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

1. Vercel ‚Üí **Deployments** ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π ‚Üí **Logs**
2. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - `‚úÖ PostgreSQL connected successfully`
   - `‚úÖ Redis client connected`
   - `‚úÖ Database tables initialized`
   - `‚úÖ Telegram bot started successfully`

**–ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è "Telegram bot started successfully":**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç

**–ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –Ω–∞ –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `TELEGRAM_BOT_TOKEN` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Health Check API

## üîß –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Health Check –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ë–î

**–°–∏–º–ø—Ç–æ–º—ã:**
```json
{
  "status": "degraded",
  "databases": {
    "postgres": "error",
    "redis": "error"
  }
}
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ Vercel
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `REDIS_URL` –≤ Vercel
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Connection Strings –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω (–Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞ –∏–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞)
2. Webhook –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è webhook)
3. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Telegram API

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel:
   - –ò—â–∏—Ç–µ `‚úÖ Telegram bot started successfully`
   - –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ Vercel
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —É @BotFather

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL

**–°–∏–º–ø—Ç–æ–º—ã –≤ –ª–æ–≥–∞—Ö:**
- `PostgreSQL connection error`
- `connection refused`
- `authentication failed`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL`:
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: `postgresql://user:password@host:port/database`
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ Connection Pooling –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Supabase –±–∞–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis

**–°–∏–º–ø—Ç–æ–º—ã –≤ –ª–æ–≥–∞—Ö:**
- `Redis Client Error`
- `connection refused`
- `authentication failed`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `REDIS_URL`:
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: `rediss://default:password@host:port`
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Upstash Redis —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `rediss://` (—Å –¥–≤—É–º—è 's') –¥–ª—è TLS

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

- [ ] Health Check API —Ä–∞–±–æ—Ç–∞–µ—Ç (`/health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `status: "ok"`)
- [ ] PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω (`postgres: "connected"`)
- [ ] Redis –ø–æ–¥–∫–ª—é—á–µ–Ω (`redis: "connected"`)
- [ ] –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω—ã –≤ Vercel
- [ ] `DATABASE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- [ ] `REDIS_URL` –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- [ ] `TELEGRAM_BOT_TOKEN` —É–∫–∞–∑–∞–Ω –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- [ ] –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- [ ] –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å `‚úÖ Telegram bot started successfully`
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/start` –≤ Telegram

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –ø–æ–ª–Ω–æ—Å—Ç—å—é:**
   - Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π ‚Üí Logs
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤—Å–µ –ª–æ–≥–∏ –∏ –∏—â–∏—Ç–µ –æ—à–∏–±–∫–∏

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots`
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∑–∞–Ω–æ–≤–æ
   - –û–±–Ω–æ–≤–∏—Ç–µ –≤ Vercel

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Connection Strings:**
   - Supabase: –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
   - Upstash: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Redis –¥–æ—Å—Ç—É–ø–µ–Ω

4. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å –Ω—É–ª—è:**
   - –£–¥–∞–ª–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Vercel
   - –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ

